<!doctype html>
<html lang="en">
      <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
        <title>E-commerce Michael</title>
        <!--  stylesheet public (bootstrap icons typography)  -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
       <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
       <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
         <link rel="stylesheet" href="../../../public/lib/animate.css" type="text/css" media="all" />

        <!--   stylesheet local path  -->
       <link rel="stylesheet" href="../../../public/css/style.css" type="text/css" media="all" />
    </head>
    <body>
        <!-- start code logo nav and search box -->
        <nav class="navbar fixed-top navbar-dark navbar-expand-lg nav-top">
          <div class="container-fluid">
            <a class="navbar-brand nav-logo-text" href="#">Michstoree.</a>
            <div class="d-flex gap-2">
            <div class="rounded justify-content-center align-items-center bg-transparent px-3 notif-sm" onclick="showNotif()" style="display:flex;">
              <i class="bi bi-bell animate__animated animate__swing animate__infinite" style="color:#319de2;font-size:1.5em;"></i>
            </div>
            <button class="navbar-toggler m-0 navbar-top-btn" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation" style="border:0 !important;">
              <i class="bi bi-list display-4" style="border:0 !important; color:#319de2 !important;"></i>
            </button>
            </div>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <div class="navbar-nav py-2 gap-2">
            <div class="rounded justify-content-center align-items-center bg-transparent px-3 notif-lg" onclick="showNotif()" style="display:flex;">
              <i class="bi bi-bell animate__animated animate__swing animate__infinite" style="color:#319de2;font-size:1.5em;"></i>
            </div>
                <a onclick="window.location.href = '/pages/home/'" class="nav-link d-flex align-items-center" aria-current="page" href="#">
                <i class="bi i-nav bi-house"></i>Home</a>
                <a onclick="window.location.href = '/pages/product/'" class="nav-link active nav-active d-flex align-items-center" aria-current="page" href="#">
                <i class="bi i-nav bi-box-seam"></i>Product</a>
              <!--   <a onclick="window.location.href = '/pages/troli/'" class="nav-link d-flex align-items-center" aria-current="page" href="#">
              <i class="bi i-nav bi-bag"></i>Troli</a> -->
                <a onclick="window.location.href = '/pages/account/'" class="nav-link d-flex align-items-center" aria-current="page" href="#">
                <i class="bi i-nav bi-person"></i>Account</a>
              </div>
            </div>
          </div>
        </nav>
        <!-- end code logo nav and search box -->

        <!-- Spinner  shape home Start -->
       <div class="con-spiner">
        <div class="loadingio-spinner-ripple-2by998twmg8"><div class="ldio-yzaezf3dcmj">
        <div></div>
        <div></div>
        </div></div>
       </div>
        <!-- Spinner  shape home End -->
        <!-- start content value -->
        <main class="m-0 pt-5">
            <div class="container-main d-flex justify-content-center align-items-center" style="margin:0!important;padding-inline: 20px; height:700px !important;">
              <div class="rounded-2 text-dark d-flex flex-column align-items-center py-4 bg-light" style="width:350px;height:550px;">
                <div class="d-flex flex-column text-center pb-4">
                <h1 class="fw-bold m-0 text-capitalize">Transaksi</h1>
                <p class="m-0" id="date-pesanan"></p>
                </div>
                <div class="d-flex flex-column align-items-center text-center">
                  <div class="d-flex">
                  <p class="m-0 d-flex">Status : <p class="m-0 mx-1 px-1" id="show-status"></p></p>
                  </div>
                  <div class="d-flex">
                  <p class="m-0 d-flex">Id pesanan : <p class="m-0 px-1" id="show-idp">#</p></p>
                  </div>
                  <!--<div class="d-flex">
                  <p class="m-0 d-flex">Buyer : <p class="m-0 px-1" id="show-usn"></p></p>
                  </div> -->
                  <div class="d-flex">
                  <p class="m-0 d-flex">Product : <p class="m-0 px-1" id="show-product-buyer"></p></p>
                  </div>
                  <div class="d-flex">
                  <p class="m-0 d-flex">Total Harga : <p class="m-0 px-1" id="show-price-buyer">Rp</p></p>
                  </div>
                  <div class="d-flex">
                  <p class="m-0 d-flex">Estimasi : <p class="m-0 px-1" id="show-est-buyer"></p></p>
                  </div>
                  <div class="d-flex">
                  <p class="m-0 d-flex">Payment : <p class="m-0 px-1 mx-1 px-1 text-light" id="show-pay-buyer"></p></p>
                  </div>
                  <div class="d-none" id="if-proses">
                  <p class="m-0 d-flex px-5">Silakan melakukan pembayaran dengan mengscan qr / mengirim ke nomor yang tersedia dengan nominal yang benar. </p>
                  </div>
                  <div class="mt-4 gap-2 flex-column" id="gopay-qr" style="display:none;">
                    <img src="../../../public/img/qr-mich.png" alt="" style="width:150px;" />
                    <p class="m-0">0895-4115-86360</p>
                  </div>
                  <div class="mt-5 pb-5 fw-bold flex-column" id="pulsa-no" style="display:none;">
                    <p class="m-0" style="font-size:2em;">0895-4115-86360</p>
                  </div>
                  <button id="btn-konfirm-pay" onclick="konfirmOder()" class="w-75 rounded-2 bg-warning border-0 py-2 my-2 ">Konfirmasi Pembayaran</button>
                </div>
              </div>
            </div>
              <div class="position-fixed fixed-top w-100 justify-content-center align-items-center" style="display:flex;height:100vh;left:0; background:rgba(225,225,225,.2);backdrop-filter: blur(5px); z-index:99999;" id="searchIdPesanan">
                <div class="w-75 d-flex justify-content-center align-items-center text-center rounded-2 flex-column text-light gap-3 px-5" style="background:#319de2; height:350px;">
                  <p class="m-0">Masukan id pesanan yang ingin kamu cari</p>
                  <input type="text" class="rounded-2 border-0 w-100 py-1 px-2" name="" id="inputIdPesanan" value="" placeholder="tulis id pesanan tanpa '#'.." />
                  <button class="bg-warning py-2 text-light rounded-2 w-100 mx-3 border-0" id="btn-search-id" onclick="searchIdp()">Cari pesanan</button>
                </div>
              </div>
            <!-- start footer bootom sticky -->
              <footer class="bg-dark py-5">
                <div class="div-img-footer">
                  <h2 class="fw-bold py-2" style="font-family:'Outfit', sans-serif;">
                    MichStore.
                  </h2>
                </div>
                <div class="div-text-footer gap-3">
              <div class="d-flex flex-column gap-1 mt-2">
                <h6 style="border-bottom:1px solid gray;">Media Social</h6>
                <p class="m-0" onclick="window.location.href = 'https://www.instagram.com/michaeltopup.id?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw=='"><i class="bi bi-instagram px-2"></i>@michaeltopup.id</i>
                <p class="m-0" onclick="window.location.href = 'https://www.tiktok.com/@michaeltopup.id'"><i class="bi bi-tiktok px-2"></i>@michaeltopup.id</i>
                <p class="m-0" onclick="window.location.href = 'https://wa.me/+62895411586360'"><i class="bi bi-whatsapp px-2"></i>+62-895-4115-86360</i>
              </div>
              <div class="d-flex flex-column gap-1 mt-2">
                <h6 style="border-bottom:1px solid gray;">Support</h6>
                <p class="m-0" onclick="window.location.href = 'mailto:Michaelganteng3322@gmail.com?subject=feedback'"><i class="bi bi-envelope px-2"></i>Michaelganteng3322@gmail.com</p>
                <p class="m-0" onclick="window.location.href = 'mailto:zeruprogram@gmail.com?subject=feedback'"><i class="bi bi-envelope px-2"></i>zeruprogram@gmail.com</p>
                <p class="m-0">Proses Instant dan dijamin cepat!</p>
              </div>
                 </div>
                <div class="div-text-footer py-2">
              <div class="d-flex flex-column gap-1 mt-2">
                <h6 style="border-bottom:1px solid gray;">Information</h6>
                <p class="m-0">Build in February 2024</p>
                <p class="m-0">Release in March 2024</p>
                <p class="m-0" onclick="window.location.href='https://zeru.netlify.app/'">Created By Zeru PGM</p>
              </div>
                </div>
                <div class="cpryt mt-3">Â© 2024 MICHSTORE. All right reversed.<br>version app 1.5.0</div>
              </footer>

            <!-- end footer bootom sticky -->
        </main>
        <!-- end content value -->


        <div class="d-none w-100 position-fixed notif-popup" style="top: 0; left: 0; z-index: 9999999; height: 100vh;background: rgb(59,72,86);background: linear-gradient(90deg, rgba(59,72,86,1) 0%, rgba(79,116,154,1) 50%, rgba(70,123,180,1) 100%);">
          <button class="position-fixed top-0 m-2 rounded-2 bg-light border-0" onclick="closeNotif()" style="right:0; width:50px;height:50px;">X</button>
        </div>

        <!-- script js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
        <script type="text/javascript" src="../../../public/js/script.js"></script>
        <script>  
        const dataPesanan = document.getElementById('date-pesanan');
        const dataStatus = document.getElementById('show-status');
        const dataId = document.getElementById('show-idp');
        const dataUsn = document.getElementById('show-usn');
        const dataProductBuyer = document.getElementById('show-product-buyer');
        const dataPriceBuyer = document.getElementById('show-price-buyer');
        const dataEstimasiBuyer = document.getElementById('show-est-buyer');
        const dataPayBuyer = document.getElementById('show-pay-buyer');
        const payQrGp = document.getElementById("gopay-qr")
        const payPulsa = document.getElementById("pulsa-no")
        const dataPayPanduan = document.getElementById("if-proses")
        const dataBtnKonfirm = document.getElementById("btn-konfirm-pay")
        const divSP = document.getElementById("searchIdPesanan")
   fetch('https://script.google.com/macros/s/AKfycbw_R1cTfsM1bGNmzMt0B7irEUia5Azz8PHAwDIWe3HGQbjYABHGrI-oBQJha3KlJYaHKA/exec')
    .then(res => res.json())
    .then(data => {
       const urlParams = new URLSearchParams(window.location.search);
      const idFromURL = urlParams.get('id');
      const decodedId = decodeURIComponent(idFromURL);
      
      const matchedRow = data.content.find(row => row[1] === decodedId);
        if (idFromURL) {
       data.content.slice(1).forEach(row => {      
      if (matchedRow) {
          divSP.style.display = 'none';
          dataPesanan.textContent = matchedRow[7];
          if (row[8] === 'proses') {
          dataStatus.textContent = row[8];
          dataStatus.classList.add('bg-warning');
          dataPayPanduan.classList.remove('d-none')
          dataPayPanduan.classList.add('d-flex')
          dataBtnKonfirm.style.display = 'block';
          } else if (row[8] === 'sukses') {
          dataStatus.textContent = row[8];
          dataStatus.classList.add('bg-success');
          dataStatus.classList.add('text-light');
          dataBtnKonfirm.style.display = 'none';
          }
          dataId.textContent = "#" + row[1];
       //   dataUsn.textContent = row[2];
          dataProductBuyer.textContent = row[3];
          dataPriceBuyer.textContent = row[4];
          dataEstimasiBuyer.textContent = row[6];
          if (row[5] === 'gopay') {
          dataPayBuyer.textContent = 'gopay';
          dataPayBuyer.classList.add("bg-success");
          dataPayBuyer.classList.add("text-light");
          payQrGp.style.display = 'flex';
          payPulsa.style.display = 'none';
          } else if (row[5] === 'dana') {
          dataPayBuyer.textContent = 'dana';
          dataPayBuyer.classList.add("bg-primary");
          dataPayBuyer.classList.add("text-light");
          payPulsa.style.display = 'flex';
          payQrGp.style.display = 'none';
          } else if (row[5] === 'spay') {
          dataPayBuyer.textContent = 'ShopeePay';
          dataPayBuyer.classList.add("bg-warning");
          payPulsa.style.display = 'flex';
          payQrGp.style.display = 'none';
          } else if (row[5] === 'pulsa 3') {
          dataPayBuyer.textContent = 'Pulsa 3';
          dataPayBuyer.classList.add("bg-secondary");
          payPulsa.style.display = 'flex';
          payQrGp.style.display = 'none';
          } 
      } else {
        alert("data tidak ditemukan")
      }
      
       })
        }
    });
    
    function searchIdp() {
      var input = document.getElementById('inputIdPesanan').value;
      document.getElementById('btn-search-id').textContent = "loading..";
       fetch('https://script.google.com/macros/s/AKfycbw_R1cTfsM1bGNmzMt0B7irEUia5Azz8PHAwDIWe3HGQbjYABHGrI-oBQJha3KlJYaHKA/exec')
    .then(res => res.json())
    .then(data => {
      const matchedRow = data.content.find(row => row[1] === input);
        
       data.content.slice(1).forEach(row => {      
      if (matchedRow) {
          divSP.style.display = 'none';
          dataPesanan.textContent = matchedRow[7];
          if (row[8] === 'proses') {
          dataStatus.textContent = row[8];
          dataStatus.classList.add('bg-warning');
          dataPayPanduan.classList.remove('d-none')
          dataPayPanduan.classList.add('d-flex')
          dataBtnKonfirm.style.display = 'block';
          } else if (row[8] === 'sukses') {
          dataStatus.textContent = row[8];
          dataStatus.classList.add('bg-success');
          dataStatus.classList.add('text-light');
          dataBtnKonfirm.style.display = 'none';
          }
          dataId.textContent = "#" + row[1];
          dataUsn.textContent = row[2];
          dataProductBuyer.textContent = row[3];
          dataPriceBuyer.textContent = row[4];
          dataEstimasiBuyer.textContent = row[6];
          if (row[5] === 'gopay') {
          dataPayBuyer.textContent = 'gopay';
          dataPayBuyer.classList.add("bg-success");
          dataPayBuyer.classList.add("text-light");
          payQrGp.style.display = 'flex';
          } else if (row[5] === 'dana') {
          dataPayBuyer.textContent = 'dana';
          dataPayBuyer.classList.add("bg-primary");
          dataPayBuyer.classList.add("text-light");
          payPulsa.style.display = 'flex';
          } else if (row[5] === 'spay') {
          dataPayBuyer.textContent = 'ShopeePay';
          dataPayBuyer.classList.add("bg-warning");
          payPulsa.style.display = 'flex';
          } else if (row[5] === 'pulsa 3') {
          dataPayBuyer.textContent = 'Pulsa 3';
          dataPayBuyer.classList.add("bg-secondary");
          payPulsa.style.display = 'flex';
          } 
      } else {
          alert('Data tidak ditemukan!');
      }
      
       })
    });
    }
    
    
    function konfirmOder() { 
      dataBtnKonfirm.textContent = 'loading..';
      fetch('https://script.google.com/macros/s/AKfycbw_R1cTfsM1bGNmzMt0B7irEUia5Azz8PHAwDIWe3HGQbjYABHGrI-oBQJha3KlJYaHKA/exec')
      .then(res => res.json())
      .then(data => {
       const urlParams = new URLSearchParams(window.location.search);
      const idFromURL = urlParams.get('id');
      const decodedId = decodeURIComponent(idFromURL);
      const matchedRow = data.content.find(row => row[1] === decodedId);
       data.content.slice(1).forEach(row => {
     if (matchedRow) {
      const message = `
      *Hallo admin/owner!*
      saya ${row[2]}, ingin mengkonfirmasi pesanan order saya dengan id ${row[1]}, telah [dibayar/dikirim] dengan metode pembayaran ${row[5]}, mohon dicek dan segera diproses. Terimakasih!
      
      _pastikan ${row[2]} telah benar-benar melakukan pembayaran/pengiriman ke qr/nomor yang tepat!_
      `
      window.location.href = 'https://wa.me/62895411586360?text=' + encodeURIComponent(message);
     } else {
       alert('erorr 401')
     }
      })
    })
    .catch(e => console.error(error.message))
    }
       </script>
    </body>
</html>
